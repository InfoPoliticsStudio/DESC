<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Login Page</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen">

  <!-- Login Card -->
  <div class="bg-white p-8 rounded-lg shadow-lg w-full max-w-md">
    <h2 class="text-2xl font-bold text-center mb-6">เข้าสู่ระบบ</h2>
    <form id="loginForm">
      <div class="mb-4">
        <label for="username" class="block text-sm font-medium text-gray-700">ชื่อผู้ใช้</label>
        <input type="text" id="username" name="username" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm" required>
      </div>
      <div class="mb-6">
        <label for="password" class="block text-sm font-medium text-gray-700">รหัสผ่าน</label>
        <input type="password" id="password" name="password" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm" required>
      </div>
      <button type="submit" class="w-full bg-blue-500 text-white py-2 px-4 rounded-lg hover:bg-blue-600">เข้าสู่ระบบ</button>
    </form>
    <p id="error" class="text-red-500 text-sm mt-4 hidden">ชื่อผู้ใช้หรือรหัสผ่านไม่ถูกต้อง</p>
  </div>

  <script>
    document.getElementById('loginForm').addEventListener('submit', async function(e) {
    e.preventDefault();
  
    const username = document.getElementById('username').value;
    const password = document.getElementById('password').value;
  
    try {
      const response = await fetch('https://script.google.com/macros/s/AKfycbwe01xrLXX1lkTQfXy7ae0Y9liHR7r0pVdSVHjuIKU-vm4f6VNw8FKerlw2VPlKlNoZ/exec');
      const data = await response.json();
  
      console.log(data); // Debug: ดูว่า JSON มีโครงสร้างอย่างไร
  
      // ตรวจสอบว่า data เป็น array หรือ object
      if (Array.isArray(data)) {
        // กรณีที่ data เป็น array
        const user = data.find(user => user.username === username && user.password === password);
        if (user) {
          alert(`ยินดีต้อนรับ, ${user.name}`);
          window.location.href = "/dashboard.html";
        } else {
          document.getElementById('error').classList.remove('hidden');
        }
      } else {
        // กรณีที่ data เป็น object (ตามตัวอย่าง JSON ที่คุณให้)
        if (data.username === username && data.password === password) {
          alert(`ยินดีต้อนรับ, ${data.name}`);
          window.location.href = "/dashboard.html";
        } else {
          document.getElementById('error').classList.remove('hidden');
        }
      }
    } catch (error) {
      console.error('Error fetching data:', error);
      alert('เกิดข้อผิดพลาด กรุณาลองใหม่อีกครั้ง');
    }
  });

  </script>

</body>
</html>
